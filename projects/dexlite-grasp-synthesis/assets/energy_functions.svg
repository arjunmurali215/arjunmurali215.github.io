<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 600">
  <defs>
    <linearGradient id="force-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="dist-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6"/>
      <stop offset="100%" style="stop-color:#1D4ED8"/>
    </linearGradient>
    <linearGradient id="pen-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#EF4444"/>
      <stop offset="100%" style="stop-color:#DC2626"/>
    </linearGradient>
    <linearGradient id="spen-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F59E0B"/>
      <stop offset="100%" style="stop-color:#D97706"/>
    </linearGradient>
    <linearGradient id="joint-grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8B5CF6"/>
      <stop offset="100%" style="stop-color:#7C3AED"/>
    </linearGradient>
    <linearGradient id="total-grad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#374151"/>
      <stop offset="100%" style="stop-color:#1F2937"/>
    </linearGradient>
    
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1100" height="600" fill="#F9FAFB"/>
  
  <!-- Title -->
  <text x="550" y="40" font-family="Inter, system-ui, sans-serif" font-size="24" font-weight="700" text-anchor="middle" fill="#111827">Energy Functions for Grasp Optimization</text>
  <text x="550" y="65" font-family="Inter, system-ui, sans-serif" font-size="13" text-anchor="middle" fill="#6B7280">Differentiable objectives for physics-based grasp refinement</text>
  
  <!-- Main container -->
  <rect x="30" y="90" width="1040" height="430" rx="12" fill="white" stroke="#E5E7EB" stroke-width="1.5" filter="url(#shadow)"/>
  
  <!-- Energy cards - Row 1 -->
  <!-- Force Closure -->
  <g transform="translate(60, 120)">
    <rect x="0" y="0" width="190" height="150" rx="10" fill="url(#force-grad)" filter="url(#shadow)"/>
    <text x="95" y="30" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" text-anchor="middle" fill="white">E_fc</text>
    <text x="95" y="50" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="rgba(255,255,255,0.9)">Force Closure</text>
    <line x1="15" y1="65" x2="175" y2="65" stroke="rgba(255,255,255,0.3)"/>
    
    <text x="95" y="88" font-family="Inter, system-ui, sans-serif" font-size="9" text-anchor="middle" fill="rgba(255,255,255,0.85)">G = [n₁, ..., nₖ]</text>
    <text x="95" y="108" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="white">min σ(GGᵀ)</text>
    
    <rect x="15" y="120" width="160" height="22" rx="4" fill="rgba(255,255,255,0.2)"/>
    <text x="95" y="135" font-family="Inter, system-ui, sans-serif" font-size="8" text-anchor="middle" fill="white">Grasp wrench space quality</text>
  </g>
  
  <!-- Contact Distance -->
  <g transform="translate(270, 120)">
    <rect x="0" y="0" width="190" height="150" rx="10" fill="url(#dist-grad)" filter="url(#shadow)"/>
    <text x="95" y="30" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" text-anchor="middle" fill="white">E_dis</text>
    <text x="95" y="50" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="rgba(255,255,255,0.9)">Contact Distance</text>
    <line x1="15" y1="65" x2="175" y2="65" stroke="rgba(255,255,255,0.3)"/>
    
    <text x="95" y="88" font-family="Inter, system-ui, sans-serif" font-size="9" text-anchor="middle" fill="rgba(255,255,255,0.85)">d(p, S) = SDF(p)</text>
    <text x="95" y="108" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="white">Σᵢ |SDF(pᵢ)|²</text>
    
    <rect x="15" y="120" width="160" height="22" rx="4" fill="rgba(255,255,255,0.2)"/>
    <text x="95" y="135" font-family="Inter, system-ui, sans-serif" font-size="8" text-anchor="middle" fill="white">Links near object surface</text>
  </g>
  
  <!-- Penetration -->
  <g transform="translate(480, 120)">
    <rect x="0" y="0" width="190" height="150" rx="10" fill="url(#pen-grad)" filter="url(#shadow)"/>
    <text x="95" y="30" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" text-anchor="middle" fill="white">E_pen</text>
    <text x="95" y="50" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="rgba(255,255,255,0.9)">Penetration</text>
    <line x1="15" y1="65" x2="175" y2="65" stroke="rgba(255,255,255,0.3)"/>
    
    <text x="95" y="88" font-family="Inter, system-ui, sans-serif" font-size="9" text-anchor="middle" fill="rgba(255,255,255,0.85)">d &lt; 0 → inside object</text>
    <text x="95" y="108" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="white">Σᵢ max(−dᵢ, 0)²</text>
    
    <rect x="15" y="120" width="160" height="22" rx="4" fill="rgba(255,255,255,0.2)"/>
    <text x="95" y="135" font-family="Inter, system-ui, sans-serif" font-size="8" text-anchor="middle" fill="white">Prevents object collision</text>
  </g>
  
  <!-- Self-Penetration -->
  <g transform="translate(690, 120)">
    <rect x="0" y="0" width="190" height="150" rx="10" fill="url(#spen-grad)" filter="url(#shadow)"/>
    <text x="95" y="30" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" text-anchor="middle" fill="white">E_spen</text>
    <text x="95" y="50" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="rgba(255,255,255,0.9)">Self-Penetration</text>
    <line x1="15" y1="65" x2="175" y2="65" stroke="rgba(255,255,255,0.3)"/>
    
    <text x="95" y="88" font-family="Inter, system-ui, sans-serif" font-size="9" text-anchor="middle" fill="rgba(255,255,255,0.85)">d(linkᵢ, linkⱼ)</text>
    <text x="95" y="108" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="white">Σᵢⱼ max(−dᵢⱼ, 0)²</text>
    
    <rect x="15" y="120" width="160" height="22" rx="4" fill="rgba(255,255,255,0.2)"/>
    <text x="95" y="135" font-family="Inter, system-ui, sans-serif" font-size="8" text-anchor="middle" fill="white">Prevents finger collision</text>
  </g>
  
  <!-- Joint Limits -->
  <g transform="translate(900, 120)">
    <rect x="0" y="0" width="150" height="150" rx="10" fill="url(#joint-grad)" filter="url(#shadow)"/>
    <text x="75" y="30" font-family="Inter, system-ui, sans-serif" font-size="14" font-weight="700" text-anchor="middle" fill="white">E_joints</text>
    <text x="75" y="50" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="rgba(255,255,255,0.9)">Joint Limits</text>
    <line x1="15" y1="65" x2="135" y2="65" stroke="rgba(255,255,255,0.3)"/>
    
    <text x="75" y="88" font-family="Inter, system-ui, sans-serif" font-size="9" text-anchor="middle" fill="rgba(255,255,255,0.85)">θ ∈ [θₘᵢₙ, θₘₐₓ]</text>
    <text x="75" y="108" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="white">Σⱼ penalty(θⱼ)</text>
    
    <rect x="15" y="120" width="120" height="22" rx="4" fill="rgba(255,255,255,0.2)"/>
    <text x="75" y="135" font-family="Inter, system-ui, sans-serif" font-size="8" text-anchor="middle" fill="white">Physical limits</text>
  </g>
  
  <!-- Total Energy Equation -->
  <g transform="translate(60, 295)">
    <rect x="0" y="0" width="990" height="100" rx="10" fill="url(#total-grad)" filter="url(#shadow)"/>
    <text x="495" y="30" font-family="Inter, system-ui, sans-serif" font-size="16" font-weight="700" text-anchor="middle" fill="white">Total Energy Function</text>
    <line x1="20" y1="45" x2="970" y2="45" stroke="rgba(255,255,255,0.2)"/>
    
    <text x="495" y="75" font-family="Inter, system-ui, sans-serif" font-size="14" text-anchor="middle" fill="white">E = E_fc + w_dis·E_dis + w_pen·E_pen + w_spen·E_spen + w_joints·E_joints</text>
  </g>
  
  <!-- Weights -->
  <g transform="translate(60, 415)">
    <rect x="0" y="0" width="990" height="85" rx="8" fill="#F3F4F6" stroke="#E5E7EB"/>
    <text x="495" y="25" font-family="Inter, system-ui, sans-serif" font-size="13" font-weight="700" text-anchor="middle" fill="#374151">Default Weights (from DexGraspNet)</text>
    <line x1="20" y1="38" x2="970" y2="38" stroke="#E5E7EB"/>
    
    <!-- Weight values -->
    <g transform="translate(80, 55)">
      <rect x="0" y="0" width="100" height="22" rx="4" fill="#D1FAE5"/>
      <text x="50" y="15" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#047857">E_fc: implicit</text>
    </g>
    
    <g transform="translate(210, 55)">
      <rect x="0" y="0" width="120" height="22" rx="4" fill="#DBEAFE"/>
      <text x="60" y="15" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#1E40AF">w_dis = 100</text>
    </g>
    
    <g transform="translate(360, 55)">
      <rect x="0" y="0" width="120" height="22" rx="4" fill="#FEE2E2"/>
      <text x="60" y="15" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#B91C1C">w_pen = 100</text>
    </g>
    
    <g transform="translate(510, 55)">
      <rect x="0" y="0" width="130" height="22" rx="4" fill="#FEF3C7"/>
      <text x="65" y="15" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#92400E">w_spen = 10</text>
    </g>
    
    <g transform="translate(670, 55)">
      <rect x="0" y="0" width="130" height="22" rx="4" fill="#EDE9FE"/>
      <text x="65" y="15" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#5B21B6">w_joints = 1</text>
    </g>
    
    <g transform="translate(830, 55)">
      <rect x="0" y="0" width="130" height="22" rx="4" fill="#F3F4F6" stroke="#9CA3AF"/>
      <text x="65" y="15" font-family="Inter, system-ui, sans-serif" font-size="10" text-anchor="middle" fill="#374151">600 iterations</text>
    </g>
  </g>
  
  <!-- Footer -->
  <text x="550" y="570" font-family="Inter, system-ui, sans-serif" font-size="11" text-anchor="middle" fill="#9CA3AF">All energies are differentiable w.r.t. grasp parameters for gradient-based optimization</text>
</svg>
